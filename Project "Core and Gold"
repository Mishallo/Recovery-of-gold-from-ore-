#!/usr/bin/env python
# coding: utf-8

# # –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞
# <div class="alert alert-block alert-info">
# –ü—Ä–∏–≤–µ—Ç, –ú–∏—Ö–∞–∏–ª! –ú–µ–Ω—è –∑–æ–≤—É—Ç –ê–Ω–≤–∞—Ä –ì–∞–Ω–∏–µ–≤, –∏ —è –±—É–¥—É –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç. –ü—Ä–µ–¥–ª–∞–≥–∞—é –æ–±—â–∞—Ç—å—Å—è –Ω–∞ ¬´—Ç—ã¬ª :) –ù–æ –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ —É–¥–æ–±–Ω–æ - –¥–∞–π –∑–Ω–∞—Ç—å, –∏ –º—ã –ø–µ—Ä–µ–π–¥–µ–º –Ω–∞ "–≤—ã". –ú–æ—è –æ—Å–Ω–æ–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî –Ω–µ —É–∫–∞–∑–∞—Ç—å –Ω–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ç–æ–±–æ—é –æ—à–∏–±–∫–∏, –∞ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å–≤–æ–∏–º –æ–ø—ã—Ç–æ–º –∏ –ø–æ–º–æ—á—å —Ç–µ–±–µ —Å—Ç–∞—Ç—å data scientist'–æ–º.
# 
# –í–∏–¥–Ω–æ, —á—Ç–æ —Ç—ã —Å—Ç–∞—Ä–∞–ª—Å—è, –¥–µ–ª–∞—è –ø—Ä–æ–µ–∫—Ç. –í—Å–µ –∫–ª—é—á–µ–≤—ã–µ —ç—Ç–∞–ø—ã –≤ —Ä–∞–±–æ—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, —Ç–∞–∫ —á—Ç–æ –≤ —Ü–µ–ª–æ–º —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –∑–∞–¥–∞—á–µ–π —Ç–µ–±–µ —É–¥–∞–ª–æ—Å—å. –ï—Å—Ç—å –µ—â—ë –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞—Å–ø–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç —Ç–≤–æ–µ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ –Ω–∏–º –ø–æ–º–µ—á–µ–Ω—ã <span style='color:Red'> –∫—Ä–∞—Å–Ω—ã–º —Ü–≤–µ—Ç–æ–º ‚ùå </span>. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —è –±—É–¥—É –æ—Å—Ç–∞–≤–ª—è—Ç—å –ø–æ–¥ —è—á–µ–π–∫–∞–º–∏, –∫ –∫–æ—Ç–æ—Ä—ã–º –æ–Ω–∏ –æ—Ç–Ω–æ—Å—è—Ç—Å—è. –ê –µ—â–µ –ø–∏—Å–∞—Ç—å –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ v{–Ω–æ–º–µ—Ä –≤–µ—Ä—Å–∏–∏}, —á—Ç–æ–±—ã –∑–Ω–∞—Ç—å, –ø—Ä–∏ –∫–∞–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ, —è –∏—Ö –æ—Å—Ç–∞–≤–ª—è–ª. –ü–æ—Å–ª–µ –∏—Ö –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –ø—Ä–∏–Ω—è—Ç. –û—Å—Ç–∞–ª–æ—Å—å —Å–æ–≤—Å–µ–º –Ω–µ–º–Ω–æ–≥–æ, –±—É–¥—É –∂–¥–∞—Ç—å —Ç–≤–æ—é —Ä–∞–±–æ—Ç—É –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ä–µ–≤—å—é üôÇ
# 
# <span style='color:Green'> –ó–µ–ª—ë–Ω—ã–º —Ü–≤–µ—Ç–æ–º ‚úÖ¬† </span> –æ—Ç–º–µ—á–µ–Ω—ã —É–¥–∞—á–Ω—ã–µ –∏ —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –æ–ø–∏—Ä–∞—Ç—å—Å—è –≤ –±—É–¥—É—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö. <span style='color:Gold'> –ñ—ë–ª—Ç—ã–º —Ü–≤–µ—Ç–æ–º ‚ö†Ô∏è</span>–≤—ã–¥–µ–ª–µ–Ω–æ —Ç–æ, —á—Ç–æ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ-–¥—Ä—É–≥–æ–º—É. –¢—ã –º–æ–∂–µ—à—å —É—á–µ—Å—Ç—å —ç—Ç–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –±—É–¥—É—â–∏—Ö –∑–∞–¥–∞–Ω–∏–π –∏–ª–∏ –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ–µ–∫—Ç —Å–µ–π—á–∞—Å (–æ–¥–Ω–∞–∫–æ —ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ).
# 
# –î–∞–≤–∞–π —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º –≤ –¥–∏–∞–ª–æ–≥–µ: –µ—Å–ª–∏ —Ç—ã —á—Ç–æ-—Ç–æ –º–µ–Ω—è–µ—à—å –≤ –ø—Ä–æ–µ–∫—Ç–µ –ø–æ –º–æ–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º ‚Äî –ø–∏—à–∏ –æ–± —ç—Ç–æ–º. –í—ã–±–µ—Ä–∏ –¥–ª—è —Å–≤–æ–∏—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∫–∞–∫–æ–π-—Ç–æ –∑–∞–º–µ—Ç–Ω—ã–π —Ü–≤–µ—Ç, —Ç–∞–∫ –º–Ω–µ –±—É–¥–µ—Ç –ª–µ–≥—á–µ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–π, –Ω–µ –∏–∑–º–µ–Ω—è–π –∏ –Ω–µ —É–¥–∞–ª—è–π –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏. –í—Å—ë —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–µ–µ
# </div>
# 

# <h1>–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ<span class="tocSkip"></span></h1>
# <div class="toc"><ul class="toc-item"><li><span><a href="#–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö" data-toc-modified-id="–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö</a></span><ul class="toc-item"><li><span><a href="#-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1" data-toc-modified-id="-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</a></span></li><li><span><a href="#-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1" data-toc-modified-id="-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</a></span></li><li><span><a href="#-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1" data-toc-modified-id="-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1-1.3"><span class="toc-item-num">1.3&nbsp;&nbsp;</span> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</a></span></li><li><span><a href="#–í—ã–≤–æ–¥-–ø–æ-–±–ª–æ–∫—É:" data-toc-modified-id="–í—ã–≤–æ–¥-–ø–æ-–±–ª–æ–∫—É:-1.4"><span class="toc-item-num">1.4&nbsp;&nbsp;</span>–í—ã–≤–æ–¥ –ø–æ –±–ª–æ–∫—É:</a></span></li><li><span><a href="#-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1" data-toc-modified-id="-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1-1.5"><span class="toc-item-num">1.5&nbsp;&nbsp;</span> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</a></span></li></ul></li><li><span><a href="#–ê–Ω–∞–ª–∏–∑-–¥–∞–Ω–Ω—ã—Ö" data-toc-modified-id="–ê–Ω–∞–ª–∏–∑-–¥–∞–Ω–Ω—ã—Ö-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö</a></span><ul class="toc-item"><li><span><a href="#–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è-–º–µ—Ç–∞–ª–ª–æ–≤-(Au,-Ag,-Pb)-–Ω–∞-—Ä–∞–∑–ª–∏—á–Ω—ã—Ö-—ç—Ç–∞–ø–∞—Ö-–æ—á–∏—Å—Ç–∫–∏" data-toc-modified-id="–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è-–º–µ—Ç–∞–ª–ª–æ–≤-(Au,-Ag,-Pb)-–Ω–∞-—Ä–∞–∑–ª–∏—á–Ω—ã—Ö-—ç—Ç–∞–ø–∞—Ö-–æ—á–∏—Å—Ç–∫–∏-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –º–µ—Ç–∞–ª–ª–æ–≤ (Au, Ag, Pb) –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —ç—Ç–∞–ø–∞—Ö –æ—á–∏—Å—Ç–∫–∏</a></span></li><li><span><a href="#-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1" data-toc-modified-id="-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1-2.2"><span class="toc-item-num">2.2&nbsp;&nbsp;</span> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</a></span><ul class="toc-item"><li><span><a href="#–í—ã–≤–æ–¥-–ø–æ-—ç—Ç–∞–ø–∞–º-–æ—á–∏—Å—Ç–∫–∏" data-toc-modified-id="–í—ã–≤–æ–¥-–ø–æ-—ç—Ç–∞–ø–∞–º-–æ—á–∏—Å—Ç–∫–∏-2.2.1"><span class="toc-item-num">2.2.1&nbsp;&nbsp;</span>–í—ã–≤–æ–¥ –ø–æ —ç—Ç–∞–ø–∞–º –æ—á–∏—Å—Ç–∫–∏</a></span></li></ul></li><li><span><a href="#–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è-—Ä–∞–∑–º–µ—Ä–æ–≤-–≥—Ä–∞–Ω—É–ª-—Å—ã—Ä—å—è-–Ω–∞-–æ–±—É—á–∞—é—â–µ–π-–∏-—Ç–µ—Å—Ç–æ–≤–æ–π-–≤—ã–±–æ—Ä–∫–∞—Ö" data-toc-modified-id="–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è-—Ä–∞–∑–º–µ—Ä–æ–≤-–≥—Ä–∞–Ω—É–ª-—Å—ã—Ä—å—è-–Ω–∞-–æ–±—É—á–∞—é—â–µ–π-–∏-—Ç–µ—Å—Ç–æ–≤–æ–π-–≤—ã–±–æ—Ä–∫–∞—Ö-2.3"><span class="toc-item-num">2.3&nbsp;&nbsp;</span>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –≥—Ä–∞–Ω—É–ª —Å—ã—Ä—å—è –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –∏ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∞—Ö</a></span><ul class="toc-item"><li><span><a href="#–í—ã–≤–æ–¥-–ø–æ—Ä–∞–∑–º–µ—Ä–∞–º-–≥—Ä–∞–Ω—É–ª" data-toc-modified-id="–í—ã–≤–æ–¥-–ø–æ—Ä–∞–∑–º–µ—Ä–∞–º-–≥—Ä–∞–Ω—É–ª-2.3.1"><span class="toc-item-num">2.3.1&nbsp;&nbsp;</span>–í—ã–≤–æ–¥ –ø–æ—Ä–∞–∑–º–µ—Ä–∞–º –≥—Ä–∞–Ω—É–ª</a></span></li></ul></li><li><span><a href="#-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1" data-toc-modified-id="-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1-2.4"><span class="toc-item-num">2.4&nbsp;&nbsp;</span> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</a></span></li><li><span><a href="#-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v2" data-toc-modified-id="-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v2-2.5"><span class="toc-item-num">2.5&nbsp;&nbsp;</span> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v2</a></span></li><li><span><a href="#C—É–º–º–∞—Ä–Ω–∞—è-–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è-–≤—Å–µ—Ö-–≤–µ—â–µ—Å—Ç–≤-–Ω–∞-—Ä–∞–∑–Ω—ã—Ö-—Å—Ç–∞–¥–∏—è—Ö:-–≤-—Å—ã—Ä—å–µ,-–≤-—á–µ—Ä–Ω–æ–≤–æ–º-–∏-—Ñ–∏–Ω–∞–ª—å–Ω–æ–º-–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–∞—Ö." data-toc-modified-id="C—É–º–º–∞—Ä–Ω–∞—è-–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è-–≤—Å–µ—Ö-–≤–µ—â–µ—Å—Ç–≤-–Ω–∞-—Ä–∞–∑–Ω—ã—Ö-—Å—Ç–∞–¥–∏—è—Ö:-–≤-—Å—ã—Ä—å–µ,-–≤-—á–µ—Ä–Ω–æ–≤–æ–º-–∏-—Ñ–∏–Ω–∞–ª—å–Ω–æ–º-–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–∞—Ö.-2.6"><span class="toc-item-num">2.6&nbsp;&nbsp;</span>C—É–º–º–∞—Ä–Ω–∞—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –≤–µ—â–µ—Å—Ç–≤ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å—Ç–∞–¥–∏—è—Ö: –≤ —Å—ã—Ä—å–µ, –≤ —á–µ—Ä–Ω–æ–≤–æ–º –∏ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–∞—Ö.</a></span></li><li><span><a href="#-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1" data-toc-modified-id="-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1-2.7"><span class="toc-item-num">2.7&nbsp;&nbsp;</span> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</a></span></li><li><span><a href="#-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1" data-toc-modified-id="-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1-2.8"><span class="toc-item-num">2.8&nbsp;&nbsp;</span> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</a></span><ul class="toc-item"><li><span><a href="#–í—ã–≤–æ–¥-–ø–æ-–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏" data-toc-modified-id="–í—ã–≤–æ–¥-–ø–æ-–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏-2.8.1"><span class="toc-item-num">2.8.1&nbsp;&nbsp;</span>–í—ã–≤–æ–¥ –ø–æ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏</a></span></li></ul></li><li><span><a href="#–í—ã–≤–æ–¥-–ø–æ-—Ä–∞–∑–¥–µ–ª—É" data-toc-modified-id="–í—ã–≤–æ–¥-–ø–æ-—Ä–∞–∑–¥–µ–ª—É-2.9"><span class="toc-item-num">2.9&nbsp;&nbsp;</span>–í—ã–≤–æ–¥ –ø–æ —Ä–∞–∑–¥–µ–ª—É</a></span></li></ul></li><li><span><a href="#–ú–æ–¥–µ–ª—å" data-toc-modified-id="–ú–æ–¥–µ–ª—å-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>–ú–æ–¥–µ–ª—å</a></span><ul class="toc-item"><li><span><a href="#-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1" data-toc-modified-id="-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1-3.1"><span class="toc-item-num">3.1&nbsp;&nbsp;</span> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</a></span></li><li><span><a href="#-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1" data-toc-modified-id="-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1-3.2"><span class="toc-item-num">3.2&nbsp;&nbsp;</span> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</a></span></li><li><span><a href="#-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1" data-toc-modified-id="-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v1-3.3"><span class="toc-item-num">3.3&nbsp;&nbsp;</span> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</a></span></li><li><span><a href="#–í—ã–≤–æ–¥-–ø–æ-—Ä–∞–∑–¥–µ–ª—É" data-toc-modified-id="–í—ã–≤–æ–¥-–ø–æ-—Ä–∞–∑–¥–µ–ª—É-3.4"><span class="toc-item-num">3.4&nbsp;&nbsp;</span>–í—ã–≤–æ–¥ –ø–æ —Ä–∞–∑–¥–µ–ª—É</a></span></li></ul></li><li><span><a href="#–û–±—â–∏–π-–≤—ã–≤–æ–¥" data-toc-modified-id="–û–±—â–∏–π-–≤—ã–≤–æ–¥-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>–û–±—â–∏–π –≤—ã–≤–æ–¥</a></span></li><li><span><a href="#–ß–µ–∫-–ª–∏—Å—Ç-–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏-–ø—Ä–æ–µ–∫—Ç–∞" data-toc-modified-id="–ß–µ–∫-–ª–∏—Å—Ç-–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏-–ø—Ä–æ–µ–∫—Ç–∞-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>–ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞</a></span><ul class="toc-item"><li><span><a href="#-–ò—Ç–æ–≥–æ–≤—ã–π-–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" data-toc-modified-id="-–ò—Ç–æ–≥–æ–≤—ã–π-–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-5.1"><span class="toc-item-num">5.1&nbsp;&nbsp;</span> –ò—Ç–æ–≥–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</a></span></li><li><span><a href="#-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v2" data-toc-modified-id="-–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π-—Ä–µ–≤—å—é–µ—Ä–∞-v2-5.2"><span class="toc-item-num">5.2&nbsp;&nbsp;</span> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v2</a></span></li></ul></li></ul></div>

# # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–æ–ª–æ—Ç–∞ –∏–∑ —Ä—É–¥—ã

# –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –ø—Ä–æ—Ç–æ—Ç–∏–ø –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è ¬´–¶–∏—Ñ—Ä—ã¬ª. –ö–æ–º–ø–∞–Ω–∏—è —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã—Ö –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π.
# 
# –ú–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∑–æ–ª–æ—Ç–∞ –∏–∑ –∑–æ–ª–æ—Ç–æ—Å–æ–¥–µ—Ä–∂–∞—â–µ–π —Ä—É–¥—ã. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –¥–æ–±—ã—á–∏ –∏ –æ—á–∏—Å—Ç–∫–∏. 
# 
# –ú–æ–¥–µ–ª—å –ø–æ–º–æ–∂–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ, —á—Ç–æ–±—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–µ —Å —É–±—ã—Ç–æ—á–Ω—ã–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏.
# 
# –í–∞–º –Ω—É–∂–Ω–æ:
# 
# 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ;
# 2. –ü—Ä–æ–≤–µ—Å—Ç–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö;
# 3. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∏ –æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å.
# 
# –ß—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç, –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º *pandas*, *matplotlib* –∏ *sklearn.* –í–∞–º –ø–æ–º–æ–∂–µ—Ç –∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è.

# ## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

# In[1]:


import pandas as pd
import numpy as np 
import matplotlib.pyplot as plt
import seaborn as sns

from sklearn.metrics import mean_absolute_error, make_scorer, mean_squared_error
from sklearn.dummy import DummyRegressor
from sklearn.pipeline import Pipeline
from sklearn.impute import SimpleImputer
from sklearn.preprocessing import StandardScaler, MinMaxScaler
from sklearn.ensemble import RandomForestRegressor
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import GridSearchCV, cross_validate, KFold
import warnings
warnings.filterwarnings("ignore")


# In[2]:


train = pd.read_csv('/datasets/gold_recovery_train_new.csv')
test = pd.read_csv('/datasets/gold_recovery_test_new.csv')
full = pd.read_csv('/datasets/gold_recovery_full_new.csv')


# In[3]:


full.info()


# In[4]:


test.info()


# In[5]:


train.info()


# In[6]:


train.duplicated().sum()


# In[7]:


test.duplicated().sum()


# In[8]:


full.duplicated().sum()


# In[9]:


train.isna().sum().sum()


# In[10]:


test.isna().sum().sum()


# In[11]:


full.isna().sum().sum()


# In[12]:


train['rougher.output.recovery']


# –í—ã–≤–æ–¥:  
# –í –¥–∞—Ç–∞—Å–µ—Ç–µ full 19439 —Å—Ç—Ä–æ–∫ –∏ 87 —Å—Ç–æ–ª–±—Ü–æ–≤, –Ω–µ—Ç —è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏ 4481 –ø—Ä–æ–ø—É—Å–∫  
# –í –¥–∞—Ç–∞—Å–µ—Ç–µ train 14149 —Å—Ç—Ä–æ–∫ –∏ 87 —Å—Ç–æ–ª–±—Ü–æ–≤, –Ω–µ—Ç —è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏ 4100 –ø—Ä–æ–ø—É—Å–∫–æ–≤  
# –í –¥–∞—Ç–∞—Å–µ—Ç–µ test 5290 —Å—Ç—Ä–æ–∫ –∏ 53 —Å—Ç–æ–ª–±—Ü–∞, –Ω–µ—Ç —è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏ 90 –ø—Ä–æ–ø—É—Å–∫–æ–≤

# <div class="alert alert-success"> ‚úÖ¬†
# <h3> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</h3>
# 
# –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –ø–µ—Ä–≤–∏—á–Ω—ã–π –æ—Å–º–æ—Ç—Ä –∏ –≤—ã–≤–æ–¥—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ
# 

# –°–æ–∑–¥–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–±–æ–≥–∞—â–µ–Ω–∏—è

# In[13]:


def efficiency_check(C, F, T):
    numerator = (C*(F-T))
    denominator =(F*(C-T))
    total = numerator / denominator * 100
    return total


# In[14]:


recovery=train.dropna().reset_index()
rougher_output_recovery=recovery['rougher.output.recovery'] # –±–∞–∑–∞
rougher_output_tail_au=recovery['rougher.output.tail_au'] # –¥–æ–ª—è –∑–æ–ª–æ—Ç–∞ –≤ –æ—Ç–≤–∞–ª—å–Ω—ã—Ö —Ö–≤–æ—Å—Ç–∞—Ö –ø–æ—Å–ª–µ —Ñ–ª–æ—Ç–∞—Ü–∏–∏/–æ—á–∏—Å—Ç–∫–∏
rougher_input_feed_au=recovery['rougher.input.feed_au'] # –¥–æ–ª—è –∑–æ–ª–æ—Ç–∞ –≤ —Å—ã—Ä—å–µ/–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–µ –¥–æ —Ñ–ª–æ—Ç–∞—Ü–∏–∏/–æ—á–∏—Å—Ç–∫–∏
rougher_output_concentrate_au=recovery['rougher.output.concentrate_au'] # –¥–æ–ª—è –∑–æ–ª–æ—Ç–∞ –≤ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–µ –ø–æ—Å–ª–µ —Ñ–ª–æ—Ç–∞—Ü–∏–∏/–æ—á–∏—Å—Ç–∫–∏


# In[15]:


total = efficiency_check(rougher_output_concentrate_au,rougher_input_feed_au,rougher_output_tail_au)
total


# In[16]:


total.min()


# In[17]:


total.max()


# –ö–∞–∫ –º—ã –≤–∏–¥–∏–º –∑–Ω–∞—á–µ–Ω–∏—è –ª–µ–∂–∞—Ç –º–µ–∂–¥—É 0 –∏ 100, —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Å—Ç–≤—É–µ—Ç –ª–æ–≥–∏–∫–µ –∏ –Ω–∞–∫–ª–∞–¥—ã–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–º—ã—Å–ª–∞ –Ω–µ—Ç

# In[18]:


mean_absolute_error(total,rougher_output_recovery)


# –ú–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ—Å—á–∏—Ç–∞–Ω—ã –≤ —Ü–µ–ª–æ–º –≤–µ—Ä–Ω–æ

# 
# <div class="alert alert-success"> ‚úÖ¬†
# <h3> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</h3>
# 
# –í–µ—Ä–Ω–æ, –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ–∫–∞–∑–∞–ª–æ—Å—å –≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π —Å—Ç–µ–ø–µ–Ω–∏ –º–∞–ª–µ–Ω—å–∫–∏–º, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ —É—Ç–≤–µ—Ä–∂–¥–∞—Ç—å –æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞—Å—Å—á—ë—Ç–∞.
# 
# 

# In[19]:


test_col = test.columns
full_col = full.columns


# In[20]:


main_list = set(full_col)-set(test_col)


# In[21]:


main_list = list(main_list)


# In[22]:


main_list=pd.Series(main_list)
main_list.sort_values()


# **–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞**

# In[23]:


full['date']


#  –í–æ–æ–±—â–µ –¥–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è –¥–∞—Ç–æ–π –∏ –≤—Ä–µ–º–µ–Ω–µ–º –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏ –ø–æ –ø—Ä–∏–∑–Ω–∞–∫—É date. –ù–µ –≤–∏–∂—É –æ—Å–æ–±–æ–≥–æ —Å–º—ã—Å–ª–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ—Ç—å—Å—è –Ω–∞ —ç—Ç–æ—Ç –ø—Ä–∏–∑–Ω–∞–∫. –¢–∞–∫ –∫–∞–∫ –ø—Ä–æ–ø—É—Å–∫–æ–≤ –Ω–µ —Ç–∞–∫ –º–Ω–æ–≥–æ —á—Ç–æ–±—ã —ç—Ç–æ –±—ã–ª–æ –ø—Ä–æ–±–ª–µ–º–æ–π, —Å–æ—Å–µ–¥–Ω–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —á–∞—Å—Ç–æ –ø–æ—Ö–æ–∂–∏ –ø–æ—ç—Ç–æ–º—É –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏ –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏—è –≤–ø–µ—Ä–µ–¥–∏ –±–ª–∞–≥–æ–¥–∞—Ä—è –º–µ—Ç–æ–¥—É `ffill`

# In[24]:


full=full.fillna(method='ffill')
train=train.fillna(method='ffill') 
test=test.fillna(method='ffill')


# <div class="alert alert-success"> ‚úÖ¬†
# <h3> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</h3>
# 
# –•–æ—Ä–æ—à–æ, —á—Ç–æ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —á–∏—Ç–∞–µ—à—å –∑–∞–¥–∞–Ω–∏–µ =) –¢—É—Ç –±—ã–ª–æ –±—ã –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–ø–æ–ª–Ω—è—Ç—å –º–µ–¥–∏–∞–Ω–æ–π –∏–ª–∏ —Å—Ä–µ–¥–Ω–∏–º, —Ç–∞–∫ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏—è —Ñ–∏—á–µ–π —Å–∏–ª—å–Ω–æ –∑–∞–≤–∏—Å—è—Ç –æ—Ç —ç—Ç–∞–ø–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
# 
# PS –∑–∞–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–æ–ø—É—Å–∫–∏ —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ –±—ã–ª–æ –º–µ—Ç–æ–¥–∞–º–∏ pandas: bfill/ interpolate , —ç—Ç–æ –≤–ø–æ–ª–Ω–µ —É–º–µ—Å—Ç–Ω–æ. –•–æ—á—É –ø–æ—Å–æ–≤–µ—Ç–æ–≤–∞—Ç—å —Ç–µ–±–µ —Å—Ç–∞—Ç—å—é, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤, –≤—ã–¥–µ–ª—è–µ—Ç –∏—Ö –ø–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã, –¥—É–º–∞—é, —Ç–µ–±–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ:¬†https://loginom.ru/blog/missing
# 
# 

# In[25]:


display(full.isna().sum().sum())
display(train.isna().sum().sum())
display(test.isna().sum().sum())


# ### –í—ã–≤–æ–¥ –ø–æ –±–ª–æ–∫—É:  
# –°—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ —Ä–∞–≤–Ω–∞ 9.82970122149377e-15, –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ—Å—á–∏—Ç–∞–Ω—ã –≤ —Ü–µ–ª–æ–º –≤–µ—Ä–Ω–æ.  
# –¢–∞–∫–∂–µ –≤ –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö –±—ã–ª–∏–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–ø—É—Å–∫–∏  
# –í test –ø—Ä–æ–ø—É—â–µ–Ω—ã —Ñ–∏—á–∏ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Ñ–∞–∑—ã –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞. –ö—Ä–æ–º–µ —Ç–æ–≥–æ –µ—Å—Ç—å –Ω–∞—à —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫ final.output.

# <div class="alert alert-warning"> ‚ö†Ô∏è
# <h3> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</h3>
# 
# –¢–æ—á–Ω–µ–µ –≤ —Ç–µ—Å—Ç–∞—Ö –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤—ã—Ö–æ–¥–Ω—ã–µ (output) –∏ —Ä–∞—Å—á–µ—Ç–Ω—ã–µ (calculation) —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏. –ó–Ω–∞—á–∏—Ç, –∏—Ö –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –µ—â–µ –Ω–µ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –∫ –º–æ–º–µ–Ω—Ç—É –Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞

# ## –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

# ###  –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –º–µ—Ç–∞–ª–ª–æ–≤ (Au, Ag, Pb) –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —ç—Ç–∞–ø–∞—Ö –æ—á–∏—Å—Ç–∫–∏

# –°–æ–∑–¥–∞–µ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤—Å–µ —Ç—Ä–µ–±—É–µ–º—ã–µ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –∏ –∏—Å—Å–ª–µ–¥—É–µ–º –∏—Ö –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö. –ü–æ–≤—Ç–æ—Ä–∏–º –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–π, –≤—Ç–æ—Ä–∏—á–Ω–æ–π –∏ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

# In[26]:


rougher_input_feed_ = []
rougher_input_feed_ = pd.DataFrame(rougher_input_feed_)
rougher_input_feed_['rougher.input.feed_ag'] = full['rougher.input.feed_ag']
rougher_input_feed_['rougher.input.feed_pb'] = full['rougher.input.feed_pb']
rougher_input_feed_['rougher.input.feed_au'] = full['rougher.input.feed_au']


# In[27]:


plt.figure(figsize=(20,10))
a = sns.set(style="darkgrid")
a = sns.boxplot(data=rougher_input_feed_)
plt.title('–í—Ö–æ–¥–Ω–∞—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –º–µ—Ç–∞–ª–ª–æ–≤', fontsize=22)
plt.show()


# In[28]:


primary_concetrates = []
primary_concetrates = pd.DataFrame(primary_concetrates)
primary_concetrates['primary_cleaner.output.concentrate_ag']=full['primary_cleaner.output.concentrate_ag']
primary_concetrates['primary_cleaner.output.concentrate_pb']=full['primary_cleaner.output.concentrate_pb']
primary_concetrates['primary_cleaner.output.concentrate_au']=full['primary_cleaner.output.concentrate_au']


# In[29]:


plt.figure(figsize=(20,10))
a = sns.set(style="darkgrid")
a = sns.boxplot(data=primary_concetrates)
plt.title('–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –º–µ—Ç–∞–ª–ª–æ–≤ –ø–µ—Ä–≤–∏—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞', fontsize=22)
plt.show()


# In[30]:


final_output_concentrate = []
final_output_concentrate = pd.DataFrame(final_output_concentrate)
final_output_concentrate['final.output.concentrate_ag']=full['final.output.concentrate_ag']
final_output_concentrate['final.output.concentrate_pb']=full['final.output.concentrate_pb']
final_output_concentrate['final.output.concentrate_au']=full['final.output.concentrate_au']


# In[31]:


plt.figure(figsize=(20,10))
a = sns.set(style="darkgrid")
a = sns.boxplot(data = final_output_concentrate)
plt.title('–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –º–µ—Ç–∞–ª–ª–æ–≤ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞', fontsize=22)
plt.show()


# **–í—ã–≤–æ–¥ –ø–æ –¥–∏–∞–≥—Ä–∞–º–º–µ —Ä–∞–∑–º–∞—Ö–∞**
# –ü–æ "—è—â–∏–∫–∞–º —Å —É—Å–∞–º–∏" –≤–∏–¥–Ω–æ, —á—Ç–æ –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–∞–ª–ª–æ–≤ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤—ã–±—Ä–æ—Å—ã. –î–ª—è –≤—Å–µ—Ö –º–µ—Ç–∞–ª–ª–æ–≤ —Å —Ö–æ–¥–æ–º –æ—á–∏—Å—Ç–∫–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–±—Ä–æ—Å–æ–≤

# <div class="alert alert-danger"> ‚ùå
# <h3> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</h3>
# 
# –†–∞–∑–≤–µ? –ö–∞–∂–µ—Ç—Å—è, —Ç—ã –Ω–µ —Ç–µ —ç—Ç–∞–ø—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å.
#     
# 
# –ù—É–∂–Ω—ã —ç—Ç–∞–ø—ã: 
#     
#     rougher.input.feed_
#     rougher.output.concentrate_
#     final.output.concentrate_
#     

# <div class="alert alert-block alert-info"><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞</b>
#     
# <b>–ò–∑–º–µ–Ω–µ–Ω–∏—è:</b> –°–æ–≥–ª–∞—Å–µ–Ω, —Å–æ –≤—Ç–æ—Ä–∏—á–Ω–æ–π —è –Ω–∞–ø—É—Ç–∞–ª. –ó–∞—á–µ–º —è —Ö–≤–æ—Å—Ç—ã (tail) –∏—Å—Å–ª–µ–¥–æ–≤–∞–ª...–ù–æ –≤—Å–µ —Ä–∞–≤–Ω–æ, –º–Ω–µ –∫–∞–∂–µ—Ç—Å—è, –∑–∞–¥–∞–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å `–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—é` –∏–º–µ–Ω–Ω–æ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ—á–∏—Å—Ç–∫–∏, –∞ —Ç–æ –µ—Å—Ç—å:  
#     —Ñ–ª–æ—Ç–∞—Ü–∏—è - `rougher.output.concentrate_`  
#     –ø–µ—Ä–≤–∏—á–Ω–∞—è - `primary_cleaner.output.concentrate_`   
#     —Ñ–∏–Ω–∞–ª—å–Ω–∞—è - `final.output.concentrate_`  
# –ù–æ —è –¥–æ–±–∞–ª—é `rougher.input.feed_` -–≤—Ö–æ–¥–Ω–æ–π<br></div> 

# –í–µ—Ä–æ—è—Ç–Ω–æ –±–æ–ª—å—à–µ–Ω—Å—Ç–≤–æ –Ω—É–ª–µ–π –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö —è–≤–ª—è–µ—é—Ç—Å—è –Ω–µ—á–µ–º –∏–Ω—ã–º –∫–∞–∫ –≤—ã–±—Ä–æ—Å–∞–º–∏, –µ—Å–ª–∏ –∏—Ö –Ω–µ —É—á–µ—Å—Ç—å –º–æ–∂–Ω–æ –ø–æ–ø–∞—Å—Ç—å –≤ –Ω–µ–ø—Ä–∏—è—Ç–Ω—É—é —Å–∏—Ç—É–∞—Ü–∏—é

# In[32]:


full = full[full['primary_cleaner.output.concentrate_ag'] > 0]
full = full[full['primary_cleaner.output.concentrate_pb'] > 0]
full = full[full['primary_cleaner.output.concentrate_au'] > 0]

full = full[full['rougher.input.feed_ag'] > 0]
full = full[full['rougher.input.feed_pb'] > 0]
full = full[full['rougher.input.feed_au'] > 0]

full = full[full['final.output.concentrate_ag'] > 0]
full = full[full['final.output.concentrate_pb'] > 0]
full = full[full['final.output.concentrate_au'] > 0]


# In[33]:


primary_concetrates = []
primary_concetrates = pd.DataFrame(primary_concetrates)
primary_concetrates['primary_cleaner.output.concentrate_ag']=full['primary_cleaner.output.concentrate_ag']
primary_concetrates['primary_cleaner.output.concentrate_pb']=full['primary_cleaner.output.concentrate_pb']
primary_concetrates['primary_cleaner.output.concentrate_au']=full['primary_cleaner.output.concentrate_au']

rougher_input_feed_ = []
rougher_input_feed_ = pd.DataFrame(rougher_input_feed_)
rougher_input_feed_['rougher.input.feed_ag'] = full['rougher.input.feed_ag']
rougher_input_feed_['rougher.input.feed_pb'] = full['rougher.input.feed_pb']
rougher_input_feed_['rougher.input.feed_au'] = full['rougher.input.feed_au']

final_output_concentrate = []
final_output_concentrate = pd.DataFrame(final_output_concentrate)
final_output_concentrate['final.output.concentrate_ag']=full['final.output.concentrate_ag']
final_output_concentrate['final.output.concentrate_pb']=full['final.output.concentrate_pb']
final_output_concentrate['final.output.concentrate_au']=full['final.output.concentrate_au']


# In[34]:


plt.figure(figsize=(20,10), dpi= 80)
sns.kdeplot(rougher_input_feed_['rougher.input.feed_ag'], shade=True, color="g", label="AG", alpha=.7)
sns.kdeplot(rougher_input_feed_['rougher.input.feed_pb'], shade=True, color="k", label="PB", alpha=.7)
sns.kdeplot(rougher_input_feed_['rougher.input.feed_au'], shade=True, color="gold", label="AU", alpha=.7)

plt.title('–í—Ö–æ–¥–Ω–∞—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –º–µ—Ç–∞–ª–ª–æ–≤', fontsize=22)
plt.xlabel("% Metal concentrate")
plt.ylabel("Friqency")
plt.legend()
plt.show()
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è AG:",rougher_input_feed_['rougher.input.feed_ag'].mean())
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è PB:",rougher_input_feed_['rougher.input.feed_pb'].mean())
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è AU:",rougher_input_feed_['rougher.input.feed_au'].mean())


# In[35]:


plt.figure(figsize=(20,10), dpi= 80)
sns.kdeplot(primary_concetrates['primary_cleaner.output.concentrate_ag'], shade=True, color="g", label="AG", alpha=.7)
sns.kdeplot(primary_concetrates['primary_cleaner.output.concentrate_pb'], shade=True, color="k", label="PB", alpha=.7)
sns.kdeplot(primary_concetrates['primary_cleaner.output.concentrate_au'], shade=True, color="gold", label="AU", alpha=.7)

plt.title('–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –º–µ—Ç–∞–ª–ª–æ–≤ –ø–µ—Ä–≤–∏—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞', fontsize=22)
plt.xlabel("% Metal concentrate")
plt.ylabel("Friqency")
plt.legend()
plt.show()
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è AG:", primary_concetrates['primary_cleaner.output.concentrate_ag'].mean())
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è PB:",primary_concetrates['primary_cleaner.output.concentrate_pb'].mean())
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è AU:",primary_concetrates['primary_cleaner.output.concentrate_au'].mean())


# In[36]:


plt.figure(figsize=(20,10), dpi= 80)
sns.kdeplot(final_output_concentrate['final.output.concentrate_ag'], shade=True, color="g", label="AG", alpha=.7)
sns.kdeplot(final_output_concentrate['final.output.concentrate_pb'], shade=True, color="k", label="PB", alpha=.7)
sns.kdeplot(final_output_concentrate['final.output.concentrate_au'], shade=True, color="gold", label="AU", alpha=.7)

plt.title('–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –º–µ—Ç–∞–ª–ª–æ–≤ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞', fontsize=22)
plt.xlabel("% Metal concentrate")
plt.ylabel("Friqency")
plt.legend()
plt.show()
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è AG:", final_output_concentrate['final.output.concentrate_ag'].mean())
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è PB:",final_output_concentrate['final.output.concentrate_pb'].mean())
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è AU:",final_output_concentrate['final.output.concentrate_au'].mean())


# **–í—ã–≤–æ–¥ –ø–æ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏**  
# –ú–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –∫–∞–∂–¥–∞—è –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ –æ—á–∏—Å—Ç–∫–∏ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –º–µ—Ç–∞–ª–ª–æ–≤ –≤ –≤–µ—â–µ—Å—Ç–≤–µ. –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ó–æ–ª–æ—Ç–∞ - –∫–∞–∫ –Ω–∞—à –≥–ª–∞–≤–Ω—ã–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å, –ø–æ –∏—Ç–æ–≥—É –≤–æ–∑—Ä–∞—Å–ª–æ —Å 32 –¥–æ 44, –∑–Ω–∞—á–µ–Ω–∏–µ –°–µ—Ä–µ–±—Ä–∞ —É–ø–∞–ª–æ —Å 8 –¥–æ 5, –∞ –≤–æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Å–≤–∏–Ω—Ü–∞ –¥–∞–∂–µ –Ω–µ–º–Ω–æ–≥–æ –≤–æ–∑—Ä–∞—Å–ª–∏ –ø–æ—Å–ª–µ –≤—Å–µ–π –æ—á–∏—Å—Ç–∫–∏ —Å 9,8 –¥–æ 10

# –ü–æ—Å–º–æ—Ç—Ä–∏–º —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ–º –º–µ—Ç–∞–ª–ª–æ–≤ –Ω–∞ —ç—Ç–∞–ø–µ —Ñ–ª–æ—Ç–∞—Ü–∏–∏

# In[37]:


plt.figure(figsize=(20,10), dpi= 80)
sns.kdeplot(full['rougher.output.concentrate_ag'], shade=True, color="g", label="AG", alpha=.7)
sns.kdeplot(full['rougher.output.concentrate_pb'], shade=True, color="k", label="PB", alpha=.7)
sns.kdeplot(full['rougher.output.concentrate_au'], shade=True, color="gold", label="AU", alpha=.7)

plt.title('–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –º–µ—Ç–∞–ª–ª–æ–≤ —Ñ–ª–æ—Ç–∞—Ü–∏—è', fontsize=22)
plt.xlabel("% Metal concentrate")
plt.ylabel("Friqency")
plt.legend()
plt.show()
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è AG:", full['rougher.output.concentrate_ag'].mean())
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è PB:",full['rougher.output.concentrate_pb'].mean())
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è AU:",full['rougher.output.concentrate_au'].mean())


# #### –í—ã–≤–æ–¥ –ø–æ —ç—Ç–∞–ø–∞–º –æ—á–∏—Å—Ç–∫–∏
# –ü–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –≤—Ö–æ–¥–Ω—ã–º –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–æ–º –ø—Ä–æ–∏–∑–æ—à–ª–∏ —Å–ª—É–¥—É—é—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è  
# –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è:  
# –ó–æ–ª–æ—Ç–∞ —É–≤–µ–ª–∏—á–∏–ª–∞—Å—å –≤ 9,8 —Ä–∞–∑  
# –°–µ—Ä–µ–±—Ä–∞ —É–º–µ–Ω—å—à–∏–ª–∞—Å—å –≤ 3 —Ä–∞–∑–∞  
# –°–≤–∏–Ω—Ü–∞ —É–≤–µ–ª–∏—á–∏–ª–∞—Å—å –≤ 1,6 —Ä–∞–∑

# ### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –≥—Ä–∞–Ω—É–ª —Å—ã—Ä—å—è –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –∏ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∞—Ö

# In[38]:


feed_size = []
feed_size = pd.DataFrame(feed_size)
feed_size['primary_cleaner.input.feed_size']=train['primary_cleaner.input.feed_size']
feed_size['rougher.input.feed_size']=train['rougher.input.feed_size']
feed_size['primary_cleaner.input.feed_size']=test['primary_cleaner.input.feed_size']
feed_size['rougher.input.feed_size']=test['rougher.input.feed_size']


# In[39]:


feed_size.describe()


# In[40]:


#for k in ['rougher', 'primary_cleaner']:
     #plt.hist(train[f'{k}.input.feed_size'], color ='b', label='–û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞', bins=50, alpha=0.5, density=True)
     #plt.hist(test[f'{k}.input.feed_size'], color ='r',label='–¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞', bins=50, alpha=0.5, density=True)

    #plt.xlabel('–†–∞–∑–º–µ—Ä –≥—Ä–∞–Ω—É–ª —Å—ã—Ä—å—è')
    #plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
    #plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –≥—Ä–∞–Ω—É–ª —Å—ã—Ä—å—è')
    #plt.grid(alpha=0.1)
    #plt.rcParams['figure.figsize']=[10,20]
    #plt.legend()
    #plt.show|
    
    #display(f'–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –≥—Ä–∞–Ω—É–ª —Å—ã—Ä—å—è –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ:', train[f'{k}.input.feed_size'].agg(['mean','std']))
    #display(f'–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –≥—Ä–∞–Ω—É–ª —Å—ã—Ä—å—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ:', test[f'{k}.input.feed_size'].agg(['mean','std']))


# In[41]:


train['rougher.input.feed_size'].hist(color ='b', label='–û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞',figsize=(9,6), bins=50, alpha=0.5, density=True)
test['rougher.input.feed_size'].hist(color ='r',label='–¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞', figsize=(9,6), bins=50, alpha=0.5, density=True)
plt.xlabel('–†–∞–∑–º–µ—Ä –≥—Ä–∞–Ω—É–ª —Å—ã—Ä—å—è')
plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –≥—Ä–∞–Ω—É–ª —Å—ã—Ä—å—è')
plt.xlim(0, 150)
display(f'–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –≥—Ä–∞–Ω—É–ª —Å—ã—Ä—å—è –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ:', train[f'rougher.input.feed_size'].agg(['mean','std']))
display(f'–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –≥—Ä–∞–Ω—É–ª —Å—ã—Ä—å—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ:', test[f'rougher.input.feed_size'].agg(['mean','std']))


# In[42]:


train['primary_cleaner.input.feed_size'].hist(color ='b', label='–û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞',figsize=(9,6), bins=50, alpha=0.5, density=True)
test['primary_cleaner.input.feed_size'].hist(color ='r',label='–¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞', figsize=(9,6),bins=50, alpha=0.5, density=True)
plt.xlabel('–†–∞–∑–º–µ—Ä –≥—Ä–∞–Ω—É–ª —Å—ã—Ä—å—è')
plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –≥—Ä–∞–Ω—É–ª —Å—ã—Ä—å—è')
plt.xlim(0, 30)
display(f'–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –≥—Ä–∞–Ω—É–ª —Å—ã—Ä—å—è –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ:', train[f'primary_cleaner.input.feed_size'].agg(['mean','std']))
display(f'–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –≥—Ä–∞–Ω—É–ª —Å—ã—Ä—å—è –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ:', test[f'primary_cleaner.input.feed_size'].agg(['mean','std']))


# In[43]:


# –Ø–ß–ï–ô–ö–ê –†–ï–í–¨–Æ–ï–†–ê

train['rougher.input.feed_size'].hist(bins=50, figsize=(9,6), density=True)
test['rougher.input.feed_size'].hist(bins=50, figsize=(9,6), density=True)
plt.xlim(0, 150)


# In[44]:


# –Ø–ß–ï–ô–ö–ê –†–ï–í–¨–Æ–ï–†–ê

train['primary_cleaner.input.feed_size'].hist(bins=100, figsize=(9,6), density=True)
test['primary_cleaner.input.feed_size'].hist(bins=100, figsize=(9,6), density=True)
plt.xlim(0, 30)


# #### –í—ã–≤–æ–¥ –ø–æ—Ä–∞–∑–º–µ—Ä–∞–º –≥—Ä–∞–Ω—É–ª  
# –ö–∞–∫ –≤–∏–¥–Ω–æ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –¥–∞–Ω–Ω—ã–µ –ø–æ –ø–µ—Ä–≤–∏—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–π –∏ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ –ø–æ—á—Ç–∏–∏ –Ω–µ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è, —Å–æ–≤—Å–µ–º –Ω–µ–º–Ω–æ–≥–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è —Å—Ä–µ–¥–Ω–µ–µ (–Ω–∞ 0,055971) –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.    
# –î–ª—è —Ñ–ª–æ—Ç–∞—Ü–∏–∏ —Ä–∞–∑–Ω–∏—Ü —á—É—Ç—å –±–æ–ª—å—à–µ –≤ —Å—Ä–µ–¥–Ω–µ–º - 4,288759 –∏ –≤ std –Ω–∞ 3,923552  
# –í –ø—Ä–∏–Ω—Ü–∏–ø–µ —Ä–∞–∑–Ω–∏—Ü—ã –±—É–∫–≤–∞–ª—å–Ω–æ –Ω–µ—Ç –∏ —Ç–∞–∫–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –≤ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏  –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–∏ –Ω–µ –ø–æ–º–µ—à–∞–µ—Ç

# <div class="alert alert-danger"> ‚ùå
# <h3> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</h3>
# 
# –°–ª–æ–∂–Ω–æ –≥–æ–≤–æ—Ä–∏—Ç—å –æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è—Ö, –Ω–µ –≤–∏–¥—è –∏—Ö –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏. –¢—É—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–µ–µ —Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏, —Ç–∞–∫ –∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö –≤ train/test –¥–∞—Ç–∞—Å–µ—Ç–∞—Ö –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è. –ù–∞–ø—Ä–∏–º–µ—Ä, —Å –ø–æ–º–æ—â—å—é `sns.distplot()` –∏–ª–∏ –∂–µ –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å `density=True` –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `plt.hist()`.
# 

# <div class="alert alert-block alert-info"><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞</b>
#     
# <b>–ò–∑–º–µ–Ω–µ–Ω–∏—è:</b> –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –≤–∏–¥–µ–ª –∫–∞–∫ –¥–µ–ª–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫ –Ω–∞ —Å–µ–º–∏–Ω–∞—Ä–µ, –Ω–æ —è —É–º–∞ –Ω–µ –ø—Ä–∏–ª–æ–∂—É –ø–æ—á–µ–º—É –æ–Ω —É –º–µ–Ω—è –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∏ —á—Ç–æ –∑–∞ –≤—ã–±—Ä–æ—Å—ã —É –Ω—É–ª—è...<br></div> 

# <div class="alert alert-danger"> ‚ùå
# 
# <h3> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v2</h3>
# 
# –ß—Ç–æ-—Ç–æ —Å –º–∞—Å—à—Ç–∞–±–æ–º –Ω–µ —Ç–∞–∫ –µ—â–µ =) –Ø –≤—ã—à–µ –ø–æ—Å—Ç—Ä–æ–∏–ª –≥—Ä–∞—Ñ–∏–∫–∏ –≤—ã–±—Ä–∞–≤ –¥—Ä—É–≥–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –≤—Å–µ –æ–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–µ–ø–µ—Ä—å

# <div class="alert alert-block alert-info"><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞</b>
#     
# <b>–ò–∑–º–µ–Ω–µ–Ω–∏—è:</b> –ò—Å–ø—Ä–∞–≤–∏–ª –ø–æ–¥ —Å–≤–æ–π –ª–∞–¥, —Ç–∞–∫ –∏ –Ω–µ –ø–æ–Ω—è–ª –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–ª –∫–æ–¥ —É —á–µ–ª–∞ —Ç—É—Ç - 33 –º–∏–Ω—É—Ç–∞:  
#     https://disk.yandex.ru/d/UFhYWRKg6y-UYg/video1871620095.mp4   
#     –ù–æ –¥–ª—è –º–µ–Ω—è –∫–æ–Ω–µ—á–Ω–æ –≥–ª–∞–≤–Ω–æ–µ - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Å–¥–∞—Ç—å ))  
#     –∞ —Ç–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–µ—Ç<br></div> 

# ###  C—É–º–º–∞—Ä–Ω–∞—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –≤–µ—â–µ—Å—Ç–≤ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å—Ç–∞–¥–∏—è—Ö: –≤ —Å—ã—Ä—å–µ, –≤ —á–µ—Ä–Ω–æ–≤–æ–º –∏ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–∞—Ö. 

# In[45]:


# –°—É–º–º–∞ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–π –º–µ—Ç—Ä–∞–ª–ª–æ–≤ –≤—Ö–æ–¥–Ω–æ–≥–æ —Å—ã—Ä—å—è
full['sum_concentrate_rougher_input'] = full['rougher.input.feed_ag']+full['rougher.input.feed_pb']+full['rougher.input.feed_sol']+full['rougher.input.feed_au']


# In[46]:


# –°—É–º–º–∞ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–π –º–µ—Ç–∞–ª–ª–æ–≤ –ø–æ—Å–ª–µ –ø–µ—Ä–≤–∏—á–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏
full['sum_rougher.output.concentrate']=full['rougher.output.concentrate_ag']+full['rougher.output.concentrate_pb']+full['rougher.output.concentrate_sol']+full['rougher.output.concentrate_au']


# In[47]:


# –°—É–º–º–∞ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–π –º–µ—Ç–∞–ª–ª–æ–≤ –ø–æ—Å–ª–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏
full['sum_final_output_concentrate']=full['final.output.concentrate_ag']+full['final.output.concentrate_pb']+full['final.output.concentrate_sol']+full['final.output.concentrate_au']


# <div class="alert alert-danger"> ‚ùå
# <h3> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</h3>
# 
# –í –∑–∞–¥–∞–Ω–∏–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–µ–µ: –ò—Å—Å–ª–µ–¥—É–π—Ç–µ —Å—É–º–º–∞—Ä–Ω—É—é –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—é –≤—Å–µ—Ö –≤–µ—â–µ—Å—Ç–≤ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Å—Ç–∞–¥–∏—è—Ö: –≤ —Å—ã—Ä—å–µ, –≤ —á–µ—Ä–Ω–æ–≤–æ–º –∏ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–∞—Ö.
#     
# 
# –≤ —Å—ã—Ä—å–µ ‚Äî —ç—Ç–æ —Å—Ç–æ–ª–±–µ—Ü rougher.input.feed_
# 
# –≤ —á–µ—Ä–Ω–æ–≤–æ–º –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–µ - —ç—Ç–æ —Å—Ç–æ–ª–±–µ—Ü rougher.output.concentrate_
# 
# –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç–µ - —ç—Ç–æ —Å—Ç–æ–ª–±–µ—Ü final.output.concentrate_‚Ä®
# 

# In[48]:


# –ò—Ç–æ–≥
sum_concentrate=['sum_concentrate_rougher_input','sum_rougher.output.concentrate','sum_final_output_concentrate']


# In[49]:


plt.figure(figsize=(20,10), dpi= 80)
sns.kdeplot(full['sum_concentrate_rougher_input'], shade=True, color="g", label="–§–ª–æ—Ç–∞—Ü–∏—è", alpha=.7)
sns.kdeplot(full['sum_rougher.output.concentrate'], shade=True, color="c", label="–ü–µ—Ä–≤–∏—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞", alpha=.7)
sns.kdeplot(full['sum_final_output_concentrate'], shade=True, color="gold", label="–§–∏–Ω–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞", alpha=.7)

plt.title('–û–±—â–∞—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –º–µ—Ç–∞–ª–ª–æ–≤', fontsize=22)
plt.xlabel("% Metal concentrate")
plt.ylabel("Friqency")
plt.legend()
plt.show()
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è –≤—Ö–æ–¥–Ω–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞:", full['sum_concentrate_rougher_input'].mean())
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è –ø–µ–µ—Ä–≤–∏—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:",full['sum_rougher.output.concentrate'].mean())
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:",full['sum_final_output_concentrate'].mean())


# –ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –∑–∞–º–µ—Ç–Ω–æ, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ 40 –æ—Å–æ–±–æ–≥–æ —Å–º—ã—Å–ª–∞ –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞ –Ω–µ –Ω–µ—Å—É—Ç –∏ –ø–æ—ç—Ç–æ–º—É –∏—Ö –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å

# <div class="alert alert-success"> ‚úÖ¬†
# <h3> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</h3>
# 
# –í—Å–µ –≤–µ—Ä–Ω–æ, —Ç–∞–∫–∏–µ –≤—ã–±—Ä–æ—Å—ã –º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω—ã, –ª—É—á—à–µ –∏—Ö —É–±—Ä–∞—Ç—å.
# 
# 

# In[50]:


full = full[full['sum_final_output_concentrate'] > 40]
full = full[full['sum_rougher.output.concentrate'] > 40]
full = full[full['sum_concentrate_rougher_input'] > 40]


# In[51]:


plt.figure(figsize=(20,10), dpi= 80)
sns.kdeplot(full['sum_concentrate_rougher_input'], shade=True, color="g", label="–§–ª–æ—Ç–∞—Ü–∏—è", alpha=.7)
sns.kdeplot(full['sum_rougher.output.concentrate'], shade=True, color="c", label="–ü–µ—Ä–≤–∏—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞", alpha=.7)
sns.kdeplot(full['sum_final_output_concentrate'], shade=True, color="gold", label="–§–∏–Ω–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞", alpha=.7)

plt.title('–û–±—â–∞—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –º–µ—Ç–∞–ª–ª–æ–≤', fontsize=22)
plt.xlabel("% Metal concentrate")
plt.ylabel("Friqency")
plt.legend()
plt.show()
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è –≤—Ö–æ–¥–Ω–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞:", full['sum_concentrate_rougher_input'].mean())
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:",full['sum_rougher.output.concentrate'].mean())
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:",full['sum_final_output_concentrate'].mean())


# –¢–∞–∫ –∫–∞–∫ –º—ã —É–±—Ä–∞–ª–∏ —ç—Ç–∏ 40% –∏–∑ full –≤—ã–±–æ—Ä–∫–∏ –Ω—É–∂–Ω–æ —É–±—Ä–∞—Ç—å –∏—Ö –∏ –∏–∑ train, —á—Ç–æ–±—ã –Ω–µ –ø—É—Ç–∞—Ç—å –º–æ–¥–µ–ª—å

# In[52]:


train['sum_concentrate_rougher_input'] = train['rougher.input.feed_ag']+train['rougher.input.feed_pb']+train['rougher.input.feed_sol']+train['rougher.input.feed_au']


# In[53]:


train['sum_rougher.output.concentrate']=train['rougher.output.concentrate_ag']+train['rougher.output.concentrate_pb']+train['rougher.output.concentrate_sol']+train['rougher.output.concentrate_au']


# In[54]:


train['sum_final_output_concentrate']=train['final.output.concentrate_ag']+train['final.output.concentrate_pb']+train['final.output.concentrate_sol']+train['final.output.concentrate_au']


# In[55]:


train=train[train['sum_final_output_concentrate']>40]
train=train[train['sum_rougher.output.concentrate']>40]
train=train[train['sum_concentrate_rougher_input']>40]
train=train.reset_index()


# In[56]:


plt.figure(figsize=(20,10), dpi= 80)
sns.kdeplot(train['sum_concentrate_rougher_input'], shade=True, color="g", label="–í—Ö–æ–¥–Ω–æ–π", alpha=.7)
sns.kdeplot(train['sum_rougher.output.concentrate'], shade=True, color="c", label="–ü–µ—Ä–≤–∏—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞", alpha=.7)
sns.kdeplot(train['sum_final_output_concentrate'], shade=True, color="gold", label="–§–∏–Ω–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞", alpha=.7)

plt.title('–û–±—â–∞—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –º–µ—Ç–∞–ª–ª–æ–≤', fontsize=22)
plt.xlabel("% Metal concentrate")
plt.ylabel("Friqency")
plt.legend()
plt.show()
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è –≤—Ö–æ–¥–Ω–æ–≥–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞:", train['sum_concentrate_rougher_input'].mean())
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:",train['sum_rougher.output.concentrate'].mean())
print("–°—Ä–µ–¥–Ω–µ–µ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:",train['sum_final_output_concentrate'].mean())


# In[57]:


plt.figure(figsize=(7,7))
b = sns.set(style="darkgrid")
b = sns.boxplot(data=train['sum_concentrate_rougher_input'])


# #### –í—ã–≤–æ–¥ –ø–æ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏  
# –ó–∞–º–µ—Ç–Ω–æ, —á—Ç–æ –≤–æ –≤—Ä–µ–º—è —Ñ–ª–æ—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —Å —á–µ—Ç–∫–æ–≤—ã—Ä–∞–∂–µ–Ω–Ω—ã–º –º–∞–∫—Å–∏–º—É–º –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É–±—ã–≤–∞—é—â–∏–º–∏ –∫—Ä–∞—è–º–∏. –ü–µ—Ä–≤–∏—á–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —É–º–µ–Ω—å—à–∞–µ—Ç –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—é –º–µ—Ç–∞–ª–ª–æ–≤ –≤ –≤–µ—â–µ—Å—Ç–≤–µ –ø–æ—á—Ç–∏ –Ω–∞ 5-10%. –§–∏–Ω–∞–ª—å–Ω–∞—è –∂–µ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–¥–∞–µ—Ç –Ω–∞ –≤—ã—Ö–æ–¥ —è—Ä–∫–æ –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ–µ –≤–µ—â–µ—Å—Ç–≤–æ —Å –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–µ–π –≤–æ–∫—Ä—É–≥ 69% –∏ –¥–∞–µ—Ç –±–æ–ª–µ–µ —á–∞—Å—Ç–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤–æ–∫—Ä—É–≥ 69%

# ### –í—ã–≤–æ–¥ –ø–æ —Ä–∞–∑–¥–µ–ª—É
# 1. –ë—ã–ª–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ, —á—Ç–æ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –º–µ—Ç–∞–ª–ª–æ–≤ —Ä–∞—Å—Ç–µ—Ç –Ω–∞ —ç—Ç–∞–ø–µ –ø–µ—Ä–≤–∏—á–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏, –∞ –ø–æ—Ç–æ–º —É–±—ã–≤–∞–µ—Ç –Ω–∞ –≤—Ç–æ—Ä–∏—á–Ω–æ–π, –æ–¥–Ω–∞–∫–æ, –ø–æ –∏—Ç–æ–≥—É –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –≤–µ—â–µ—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –±–æ–ª–µ–µ –Ω–∞—Å—ã—â–µ–Ω–Ω–æ –∑–æ–ª–æ—Ç–æ–º, —á–µ–º –Ω–∞ –≤—Ö–æ–¥–µ. –û–¥–Ω–∞–∫–æ, –≤–∞–∂–Ω–æ–µ –∑–∞–∞–º–µ—á–∞–Ω–∏–µ, —á—Ç–æ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è —Å–≤–∏–Ω—Ü–∞ –ø–æ—á—Ç–∏ –Ω–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è –∏–∑ —Å–º–µ—Å–∏ —Å–ø–ø—É—Å—Ç—è –≤—Å–µ —ç—Ç–∞–ø—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏.  
# 2. –†–∞—Å–ø–µ—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –≥—Ä–∞–Ω—É–ª –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–æ–≤–æ—á–Ω–æ–π –∏ —Ç–µ–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ –±—ã–ª–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–æ –∏ —Å–∏–ª—å–Ω–æ–π —Ä–∞–∑–Ω–∏—Ü—ã –≤ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –Ω–µ –±—ã–ª–æ
# 3. –°—É–º–º–∞—Ä–Ω–∞—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –º–µ—Ç–∞–ª–ª–æ–≤ –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –ø–µ—Ä–≤–∏—á–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ. –ù–∞ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Å—Ç–∞–¥–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–Ω–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —É–≤–µ–ª–µ—á–µ–Ω–∏–µ —Å–º–µ—Å–∏ –¥–æ 70%

# ## –ú–æ–¥–µ–ª—å

# - –ü–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é sMAPE –ø–æ –æ–±—Ä–∞–∑—Ü—É
# - –ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∫ –ø–æ—Å–ª–µ–¥—É—é—â–µ–º—É –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—é –º–æ–¥–µ–ª–µ–π

# ![Image%20%283%29.png](attachment:Image%20%283%29.png)

# In[58]:


def smape(target, pred):
    smape = abs(target - pred) / ((abs(target) + abs(pred))/2) * 100
    smape = smape.fillna(value=0)
    smape = sum(smape)/len(smape)
    return smape


# In[59]:


train = train[test.columns]


# In[60]:


needed_target = full.loc[:,['date','rougher.output.recovery','final.output.recovery']]


# In[61]:


train = train.merge(needed_target, on='date')
test = test.merge(needed_target, on='date')


# In[62]:


test.columns


# In[63]:


x_train_r = train.drop(['rougher.output.recovery', 'final.output.recovery', 'date'], axis=1)
x_test_r = test.drop(['rougher.output.recovery', 'final.output.recovery', 'date'], axis=1)

y_train_r = train['rougher.output.recovery']
y_test_r = test['rougher.output.recovery']

x_train_f = train.drop(['rougher.output.recovery', 'final.output.recovery', 'date'], axis=1)
x_test_f = test.drop(['rougher.output.recovery', 'final.output.recovery', 'date'], axis=1)

y_train_f = train['final.output.recovery']
y_test_f = test['final.output.recovery']


# - –ü–æ–¥–≥–∞—Ç–∞–≤–ª–∏–≤–∞–µ–º —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫ –∏ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ 
# - –£–¥–∞–ª—è–µ–º –ª–∏—à–Ω–∏–π —Å—Ç–æ–ª–±–µ—Ü, –∫–æ—Ç–æ—Ä—ã–π –ª–∏—à—å –±—É–¥–µ—Ç –º–µ—à–∞—Ç—å –æ–±—É—á–µ–Ω–∏—é –º–æ–¥–µ–ª–µ–π
# - –ü—Ä–æ–ø–∏—Å—ã–≤–∞–µ–º random_state

# In[64]:


rs=12345


# In[65]:


pipe = Pipeline([
    ('scaler', StandardScaler()),
    ('model', RandomForestRegressor(n_estimators=120, random_state=rs))
])

params = [
    {
        'model': [RandomForestRegressor(n_estimators=15, random_state=rs)],
        'model__max_features': np.linspace(0.1, 1, 10)
    }, {
        'model': [LinearRegression()]
    }
]


# - –î–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∞ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 2 –º–æ–¥–µ–ª–∏: `Random Forest Regressor, Linear Regression`
# - –° –ø–æ–º–æ—â—å—é `GridSearchCV` –ø–æ–¥–±–µ—Ä–µ–º –Ω–∞–∏–±–æ–ª–µ–µ "—É–¥–∞—á–Ω—ã–µ" –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
# - –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –∏—Å—Å–ª–µ–¥—É–µ–º—É—é –º–µ—Ç—Ä–∏–∫—É –≤ –æ–±—ä–µ–∫—Ç –æ—Ü–µ–Ω–∫–∏ (score) –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —Ä–∞–±–æ—Ç—ã –Ω–∞–¥ –∫—Ä–æ—Å—Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π. –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ make_scorer –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ sklearn. –ß–µ–º –º–µ–Ω—å—à–µ smape —Ç–µ–º –ª—É—á—à–µ –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏, –ø–æ—ç—Ç–æ–º—É –¥–ª—è –Ω–∞—Å –º–∏–Ω–∏–º—É–º smape - –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è —ç—Ç–æ–≥–æ –Ω–∞–ø–∏—à–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä greater_is_better=False

# - –ü–æ–¥–≥–æ—Ç–æ–≤–∏–º –∑–Ω–∞—á–µ–Ω–∏—è SMAPE –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ `GridSearchCV`, —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ `make_scorer`

# In[66]:


smape_score = make_scorer(smape, greater_is_better=False)


# <div class="alert alert-success"> ‚úÖ¬†
# <h3> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</h3>
# 
# `greater_is_better=False` - –æ—Ç–ª–∏—á–Ω–æ! –û–±—ã—á–Ω–æ –∑–∞–±—ã–≤–∞—é—Ç, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –∞ –¥–µ—Ñ–æ–ª—Ç–Ω–æ –æ–Ω–∞ –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É–µ—Ç—Å—è=)
# 
# –ù–µ–º–Ω–æ–≥–æ –ø—Ä–æ –∫–∞—Å—Ç–æ–º–Ω—ã–π —Å–∫–æ—Ä–∏–Ω–≥ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä `greater_is_better=False` –≤ `make_scorer` : –≤–æ—Ç –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–∞—è —Å—Ç–∞—Ç—å—è -¬†https://kiwidamien.github.io/custom-loss-vs-custom-scoring.html
#     
# –ï—Å–ª–∏ –∫—Ä–∞—Ç–∫–æ, —Ç–æ —Ç–≤–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ cross_val_score —Å–æ —Å–≤–æ–µ–π –º–µ—Ç—Ä–∏–∫–æ–π –∏ —Ñ–ª–∞–≥–æ–º `greater_is_better=False` –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–∞–∫–∏–º –∂–µ, —Ç–æ–ª—å–∫–æ —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º (–∑–Ω–∞–∫ –º–∏–Ω—É—Å - –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –±–∏–±–ª–∏–æ—Ç–µ—á–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∫–æ—Ä–µ—Ä–∞, –º–æ–∂–Ω–æ –±—Ä–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –º–æ–¥—É–ª—é), —Ç–∞–∫ –∫–∞–∫ –µ—Å—Ç—å –º–µ—Ç—Ä–∏–∫–∞ (–ø–æ –∫–æ—Ç–æ—Ä–æ–π –º—ã –≤—ã–±–∏—Ä–∞–µ–º –º–æ–¥–µ–ª—å) –∏ –µ—Å—Ç—å –ª–æ—Å—Å (–ø–æ –∫–æ—Ç–æ—Ä–æ–π –æ–±—É—á–∞–µ—Ç—Å—è –º–æ–¥–µ–ª—å). –¢–∞–∫ –≤–æ—Ç make_scorer —Å–æ–∑–¥–∞–µ—Ç –º–µ—Ç—Ä–∏–∫—É –∏–∑ –ª–æ—Å—Å–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–π —Ç—ã –≤—ã–±–∏—Ä–∞–µ—à—å –ª—É—á—à—É—é –º–æ–¥–µ–ª—å, –Ω–æ —Å–∞–º–∞ –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç –æ–±—É—á–∞—Ç—å—Å—è –ø–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å (—Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ MSE), —Ç–∞–∫ —á—Ç–æ —ç—Ç–æ –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–∏. –ü—Ä–æ—Å—Ç–æ –ø—Ä–∏–Ω—è—Ç–æ —Å—Ç–∞–≤–∏—Ç—å —Ñ–ª–∞–≥ greater_is_better=False –¥–ª—è –º–µ—Ç—Ä–∏–∫, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –ª–æ—Å—Å–∞–º–∏ (–Ω–µ –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –ª–æ—Å—Å—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, recall, precision –∏ —Ç–ø).
#     
# –ù–û –µ—Å–ª–∏ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å—Å—è –≥—Ä–∏–¥—Å–µ—Ä—á, —Ç–æ `greater_is_better=False` –Ω—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, —Ç–∞–∫ –∫–∞–∫ best_estimator_ –≤—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à—É—é –º–æ–¥–µ–ª—å –ø–æ –º–µ—Ç—Ä–∏–∫–µ —É–∂–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ =)
# 
# 
# 

#  –ü—Ä–æ–≤–æ–¥–∏–º –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—é (—Å –ø–æ–º–æ—â—å—é `KFold`) –∏ –¥–µ–ª–∏–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ 5 —á–∞—Å—Ç–µ–π

# In[67]:


cv = KFold(n_splits=5, shuffle=False)
grid_r = GridSearchCV(pipe, param_grid=params, cv=cv, n_jobs=-1, scoring=smape_score)


# <div class="alert alert-warning"> ‚ö†Ô∏è
# <h3> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</h3>
# 
# –û–±—ã—á–Ω—ã–π GridSearchCV –¥–æ–≤–æ–ª—å–Ω–æ –¥–æ–ª–≥–æ –¥–µ–ª–∞–µ—Ç —Ä–∞—Å—á–µ—Ç—ã, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏. –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –æ–±—ã—á–Ω–æ –∫–∞–∫–∏–µ-—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏–ª—å–Ω–æ –≤–∞–∂–Ω–µ–µ –¥—Ä—É–≥–∏—Ö, –ø–æ—ç—Ç–æ–º—É –ø–æ –Ω–∏–º –Ω–µ—Ç –æ—Å–æ–±–æ–≥–æ —Å–º—ã—Å–ª–∞ –∏—Ç–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è, –ø–æ—ç—Ç–æ–º—É —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å RandomizedSearchCV. –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —Ç—ã –Ω–µ–º–Ω–æ–≥–æ –ø—Ä–æ—Å—è–¥–µ—à—å –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º, –∑–∞—Ç–æ —Å–∏–ª—å–Ω–æ –≤—ã–∏–≥—Ä–∞–µ—à—å –≤ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ–±—É—á–µ–Ω–∏—è. –ê –µ—â–µ –æ—á–µ–Ω—å —Å–æ–≤–µ—Ç—É—é –∏–∑—É—á–∏—Ç—å, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ª–∏–±–æ–π optuna –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
# 
# 

# <div class="alert alert-block alert-info"><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å—Ç—É–¥–µ–Ω—Ç–∞</b>
#     
# <b>–ò–∑–º–µ–Ω–µ–Ω–∏—è:</b> –î–∞, –æ–∫–µ–π —Å–ø–∞—Å–∏–±–æ! –î–ª—è —É—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç–æ–≤ RandomizedSearchCV –∫–æ–Ω–µ—á–Ω–æ –ª—É—á—à–µ –ø–æ–¥–æ–π–¥–µ—Ç. –£—á—Ç—É –≤ —Å–ª–µ–¥—É—é—â–∏–π –ø—Ä–æ–µ–∫—Ç–∞—Ö<br></div> 

# In[68]:


get_ipython().run_cell_magic('time', '', 'grid_r.fit(x_train_r, y_train_r)')


# In[69]:


print('–õ—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:', grid_r.best_params_)
print('–õ—É—á—à–µ–µ sMAPE –∑–Ω–∞—á–µ–Ω–∏–µ:', -grid_r.best_score_)


# In[70]:


grid_f = GridSearchCV(pipe, param_grid=params, cv=cv, n_jobs=-1, scoring=smape_score)


# In[71]:


get_ipython().run_cell_magic('time', '', 'grid_f.fit(x_train_f, y_train_f)')


# - –ü–æ–¥–±–∏—Ä–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

# In[72]:


print('–õ—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:', grid_f.best_params_)
print('–õ—É—á—à–µ–µ sMAPE –∑–Ω–∞—á–µ–Ω–∏–µ:', -grid_f.best_score_)


# - –ü–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –ª—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –º–æ–¥–µ–ª—å –∏ –≤—ã—Å—á–∏—Ç—ã–≤–∞–µ–º sMAPE(rougher)

# In[73]:


pipe_r = grid_r.best_estimator_

pipe_r.fit(x_train_r, y_train_r)
y_pred = pipe_r.predict(x_test_r)

smape_r = smape(full['rougher.output.recovery'].iloc[x_test_r.index], y_pred)
print('–ó–Ω–∞—á–µ–Ω–∏–µ sMAPE(rougher):', smape_r)


# In[74]:


pipe_f = grid_f.best_estimator_
    
pipe_f.fit(x_train_f, y_train_f)
y_pred_f = pipe_f.predict(x_test_f)

smape_f = smape(full['final.output.recovery'].iloc[x_test_f.index],y_pred_f)
print('–ó–Ω–∞—á–µ–Ω–∏–µ sMAPE(final):', smape_f)


# - –ü–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –ª—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –º–æ–¥–µ–ª—å –∏ –≤—ã—Å—á–∏—Ç—ã–≤–∞–µ–º sMAPE(final)

# In[75]:


final_smape = 0.25 * smape_r + 0.75 * smape_f
print('–ò—Ç–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ sMAPE:', final_smape)


# - –í—ã—Å—á–∏—Ç—ã–≤–∞–µ–º –∏—Ç–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ sMAPE

# In[76]:


median_r = pd.Series(y_train_r.median(), index=y_test_r.index)
median_f = pd.Series(y_train_f.median(), index=y_test_f.index)

median_smape_r = smape(y_test_r, median_r)
median_smape_f = smape(y_test_f, median_f)

res = (median_smape_r*0.25) + (median_smape_f* 0.75)
print('median_smape_r:', median_smape_r)
print('median_smape_f:', median_smape_f)
print('–ó–Ω–∞—á–µ–Ω–∏–µ sMAPE –¥–ª—è –º–µ–¥–∏–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏:', res)


# In[77]:


first_model = pipe_r.score(x_test_r, y_test_r)
secound_model = pipe_f.score(x_test_f,y_test_f)

dummy_model_1 = DummyRegressor(strategy='mean', constant=None, quantile=None)
dummy_model_1.fit(x_train_r, y_train_r)
dummy_model_1.predict(y_test_r)
score_dummy_1 = dummy_model_1.score(x_test_r,y_test_r)

dummy_model_2 = DummyRegressor(strategy='mean', constant=None, quantile=None)
dummy_model_2.fit(x_train_f, y_train_f)
dummy_model_2.predict(y_test_f)
score_dummy_2 = dummy_model_2.score(x_test_f,y_test_f)

print('–ü–µ—Ä–≤–∞—è –º–æ–¥–µ–ª—å:', first_model)
print('–í—Ç–æ—Ä–∞—è –º–æ–¥–µ–ª—å:', secound_model)
print('DummyRegressor_1:', score_dummy_1)
print('DummyRegressor_2:', score_dummy_2)


# –ö–∞–∫ –º—ã –≤–∏–¥–∏–º –Ω–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã(R2) –ø–æ–ª—É—á–∏–ª–∏—Å—å –ª—É—á—à–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–π –º–æ–¥–µ–ª–∏

# <div class="alert alert-danger"> ‚ùå
# <h3> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v1</h3>
# 
# –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å —Å –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–π –º–æ–¥–µ–ª—å—é, –Ω–∞–ø—Ä–∏–º–µ—Ä —Å¬†DummyRegressor. –ò–∑ –æ–¥–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫–∏ –Ω–µ —è—Å–Ω–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –∞–¥–µ–∫–≤–∞—Ç–Ω—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–µ–π
# 
# 

# ### –í—ã–≤–æ–¥ –ø–æ —Ä–∞–∑–¥–µ–ª—É
# –ë—ã–ª–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã –º–æ–¥–µ–ª–∏ –∏ —É–ª—É—á—à–µ–Ω—ã –±–ª–∞–≥–æ–¥–∞—Ä—è GridSearchCV  
# –õ—É—á—à–µ —Å–µ–±—è –ø–æ–∫–∞–∑–∞–ª–∞ –º–æ–¥–µ–ª—å RandomForestRegressor —Å –º–µ–¥–∏–∞–Ω–Ω—ã–º –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–º smape = 4.69

# ## –û–±—â–∏–π –≤—ã–≤–æ–¥
# 
# 1) –î–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω—ã –∏ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã  
# 2) –ü—Ä–æ–≤–µ–¥–µ–Ω –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö  
# 3) –ü–æ—Å—Ç—Ä–æ–µ–Ω—ã –º–æ–¥–µ–ª–∏ –∏ –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞ –Ω–∞–∏–ª—É—á—à–∞—è    
# 4) –ë—ã–ª–∞ –Ω–∞–ø–∏—Å–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è sMAPE. –° –ø–æ–º–æ—â—å—é –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ `GridSearchCV` –±—ã–ª–∏ –ø–æ–¥–æ–±—Ä–∞–Ω—ã –ª—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è  –º–æ–¥–µ–ª–µ–π

# ## –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞

# - [x]  Jupyter Notebook –æ—Ç–∫—Ä—ã—Ç
# - [ ]  –í–µ—Å—å –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
# - [ ]  –Ø—á–µ–π–∫–∏ —Å –∫–æ–¥–æ–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ –ø–æ—Ä—è–¥–∫–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
# - [ ]  –í—ã–ø–æ–ª–Ω–µ–Ω —à–∞–≥ 1: –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã
#     - [ ]  –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ñ–æ—Ä–º—É–ª–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –æ–±–æ–≥–∞—â–µ–Ω–∏—è
#     - [ ]  –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –ø—Ä–∏–∑–Ω–∞–∫–∏, –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ
#     - [ ]  –ü—Ä–æ–≤–µ–¥–µ–Ω–∞ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
# - [ ]  –í—ã–ø–æ–ª–Ω–µ–Ω —à–∞–≥ 2: –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
#     - [ ]  –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ
#     - [ ]  –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –≥—Ä–∞–Ω—É–ª –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –∏ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–∞—Ö
#     - [ ]  –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω—ã —Å—É–º–º–∞—Ä–Ω—ã–µ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏
# - [ ]  –í—ã–ø–æ–ª–Ω–µ–Ω —à–∞–≥ 3: –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –º–æ–¥–µ–ª—å –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è
#     - [ ]  –ù–∞–ø–∏—Å–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∏—Ç–æ–≥–æ–≤–æ–≥–æ *sMAPE*
#     - [ ]  –û–±—É—á–µ–Ω–æ –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª–µ–π
#     - [ ]  –í—ã–±—Ä–∞–Ω–∞ –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å, –µ—ë –∫–∞—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ

# <div class="alert alert-block alert-info">
# <h3> –ò—Ç–æ–≥–æ–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</h3>
# 
# –ë–æ–ª—å—à–æ–µ —Å–ø–∞—Å–∏–±–æ –∑–∞ –ø—Ä–æ–¥–µ–ª–∞–Ω–Ω—É—é —Ä–∞–±–æ—Ç—É. –í–∏–¥–Ω–æ, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–æ –º–Ω–æ–≥–æ —É—Å–∏–ª–∏–π. –†–∞–±–æ—Ç–∞ –≤ —Ü–µ–ª–æ–º –∏ –∫–∞–∂–¥—ã–π —à–∞–≥ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–¥–µ–ª–∞–Ω—ã —Ö–æ—Ä–æ—à–æ. –Ø –æ—Å—Ç–∞–≤–∏–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–≤–µ—Ç–æ–≤, –Ω–∞–¥–µ—é—Å—å –æ–Ω–∏ –±—É–¥—É—Ç —É—á—Ç–µ–Ω—ã –≤ —ç—Ç–æ–º –∏–ª–∏ –±—É–¥—É—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö. –û—Å—Ç–∞–ª–æ—Å—å —Å–æ–≤—Å–µ–º —á—É—Ç—å-—á—É—Ç—å, —á—Ç–æ–±—ã —è –ø—Ä–∏–Ω—è–ª —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç:
# 
# 
# 1) –ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –≤ –∞–Ω–∞–ª–∏–∑–µ –¥–∞–Ω–Ω—ã—Ö
#     
# 2) –î–æ–±–∞–≤–∏—Ç—å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–æ–π –º–æ–¥–µ–ª—å—é
# 
# 
# –ñ–¥—É –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π =)
# 
# 

# <div class="alert alert-success"> ‚úÖ¬†
# <h3> –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v2</h3>
# 
# –û—Å—Ç–∞–ª–æ—Å—å –ø–æ–¥–ø—Ä–∞–≤–∏—Ç—å –º–æ–º–µ–Ω—Ç —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ =)

# In[ ]:




